# ElasticSearch接口实战

## 基本概念

## 插入接口

## 查询接口

## 更新接口

## 删除接口

## 搜索接口

### 通用搜索接口

**/_search**<br/>
在所有的索引中搜索所有的类型<br/><br/>

**/gb/_search**<br/>
在 gb 索引中搜索所有的类型<br/><br/>

**/gb,us/_search**<br/>
在 gb 和 us 索引中搜索所有的文档<br/><br/>

**/g*,u*/_search**<br/>
在任何以 g 或者 u 开头的索引中搜索所有的类型<br/><br/>

**/gb/user/_search**<br/>
在 gb 索引中搜索 user 类型<br/><br/>

**/gb,us/user,tweet/_search**<br/>
在 gb 和 us 索引中搜索 user 和 tweet 类型<br/><br/>

**/_all/user,tweet/_search**<br/>
在所有的索引中搜索 user 和 tweet 类型<br/><br/>

### 分页

在之前的 空搜索 中说明了集群中有 14 个文档匹配了（empty）query 。 但是在 hits 数组中只有 10 个文档。如何才能看到其他的文档？

和 SQL 使用 LIMIT 关键字返回单个 page 结果的方法相同，Elasticsearch 接受 from 和 size 参数：

<br/>
**size**<br/>
显示应该返回的结果数量，默认是 10<br/><br/>

**from**<br/>
显示应该跳过的初始结果数量，默认是 0<br/><br/>

如果每页展示 5 条结果，可以用下面方式请求得到 1 到 3 页的结果：

```
GET /_search?size=5
GET /_search?size=5&from=5
GET /_search?size=5&from=10
```

#### 在分布式系统中深度分页

理解为什么深度分页是有问题的，我们可以假设在一个有 5 个主分片的索引中搜索。 当我们请求结果的第一页（结果从 1 到 10 ），每一个分片产生前 10 的结果，并且返回给 协调节点 ，协调节点对 50 个结果排序得到全部结果的前 10 个。

现在假设我们请求第 1000 页--结果从 10001 到 10010 。所有都以相同的方式工作除了每个分片不得不产生前10010个结果以外。 然后协调节点对全部 50050 个结果排序最后丢弃掉这些结果中的 50040 个结果。

可以看到，在分布式系统中，对结果排序的成本随分页的深度成指数上升。这就是 web 搜索引擎对任何查询都不要返回超过 1000 个结果的原因。
